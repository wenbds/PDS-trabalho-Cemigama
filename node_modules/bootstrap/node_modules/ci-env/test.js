const test = require("ava");

const {
  buildUrl,
  jobUrl,
  repo,
  sha,
  event,
  commit_message,
  pull_request_number,
  branch,
  ci,
  platform
} = require("./index");

if (ci) {
  console.log("values: ", {
    repo,
    sha,
    event,
    commit_message,
    pull_request_number,
    branch,
    ci
  });

  test("ci is correctly set", t => {
    if (process.env.TRAVIS) t.is(ci, "travis");
    else if (process.env.CIRCLECI) t.is(ci, "circle");
    else if (process.env.WERCKER) t.is(ci, "wercker");
    else if (process.env.DRONE) t.is(ci, "drone");
    else if (process.env.CI_NAME === "codeship") t.is(ci, "codeship");
    else if (process.env.GITHUB_ACTION) t.is(ci, "github_actions");
    else if (process.env.GITLAB_CI) t.is(ci, "gitlab");
    else if (process.env.CF_BUILD_URL) t.is(ci, "codefresh");
    else if (process.env.CF_PAGES) t.is(ci, "cloudflare");
  });

  test("repo is correctly set", t => {
    if (process.env.GITLAB_CI) t.is(repo, process.env.CI_PROJECT_PATH);
    else t.is(repo, "siddharthkp/ci-env");
  });

  test("sha is set", t => {
    const real_sha =
      process.env.TRAVIS_PULL_REQUEST_SHA ||
      process.env.TRAVIS_COMMIT ||
      process.env.CIRCLE_SHA1 ||
      process.env.WERCKER_GIT_COMMIT ||
      process.env.DRONE_COMMIT ||
      process.env.GITHUB_SHA ||
      process.env.CI_COMMIT_SHA || //gitlab
      process.env.CF_REVISION ||
      process.env.CF_PAGES_COMMIT_SHA;

    t.is(sha, real_sha);
  });

  test("commit_message is set", t => {
    const real_commit_message =
  